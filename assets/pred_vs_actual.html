import plotly.graph_objects as go
plot_df = merged_df.iloc[X_test.index][["calories"]].copy()
plot_df["pred"] = gs.best_estimator_.predict(X_test)

fig_pred = px.scatter(plot_df, x="calories", y="pred",
                      title="Final Model: Actual vs. Predicted Calories",
                      labels={"calories": "Actual", "pred": "Predicted"})
fig_pred.add_trace(go.Scatter(x=[0, plot_df["calories"].max()],
                              y=[0, plot_df["calories"].max()],
                              mode="lines", name="Perfect Fit"))
fig_pred.write_html("assets/pred_vs_actual.html", include_plotlyjs="cdn")
